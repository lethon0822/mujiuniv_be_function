<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.muziuniv_be_notuser.app.staff.approval.ApprovalMapper">

    <select id="applicationList">
        SELECT a.app_id, a.user_id, a.created_at, a.status, a.reason,
        sc.schedule_type, sm.year, sm.semester
        FROM application a
        JOIN schedule sc ON a.schedule_id = sc.schedule_id
        JOIN semester sm ON sc.semester_id = sm.semester_id
        WHERE sm.year = #{year} AND sm.semester = #{semester}
        <if test="scheduleType != null and scheduleType != ''">
            AND sc.schedule_type = #{scheduleType}
        </if>
    </select>


    <!-- 신청서 승인 여부 결정   -->
    <update id="modifyStatus">
        UPDATE application
        SET status = #{status}
        WHERE app_id = #{appId}
    </update>

</mapper>